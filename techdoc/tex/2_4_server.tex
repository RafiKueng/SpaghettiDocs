\subsection{Server}
\label{sec:server}

\subsubsection{Usecase}
The application server needs to manage all the data needed and generated by the client app.
It has to keep track of lenses, that can be modeled (\T{LensData}) objects and created models (\T{ModellingResult} objects).

The application server provides the client unified access to survey images hosted on several possible external data sources (at the moent, spacewarps and masterlens are implemented). It needs to assign each image a unique ID to be able to keep track of it.

Additionaly, it has to keep track which results are for which model, which user created the results and which results are descendants from each other.
This is a typical application for a data base.
The server manages a database and guarrantees its consitency.

Additionally, it is the interface between the client app and the worker application, that does the actual modeling. It has to convert the data generated by the client (JSON) to a format that the modeling application requires (GLASS config files).
Further, once a model / result is simulated, the server creates figures and sends them back to the client for display.



\subsubsection{Techniques used}

The server is implemented in Python language, using the Django framework. Django follows a model-view-controller architecture.
It defines a data model which is represented in a relational data base.
A view is a representation of a subset of this data presented to a user (the client app in this case).
The user can use a controller, to manipulate the data model.

The data model is defined by defining Python classes (\befn{ModellerApp/models.py}). Django uses a relational database in the backend, to keep track of all the created instances of those models.

Views and controllers are defined by Python functions (\befn{ModellerApp/views.py}).
Those functions get mapped to HTTP requests by \befn{lmt/urls.py}.
They process a request and either query the model / database to return a representation of the data or update the data.

For the actual storage of the data, Django relies on a external relational database.
For \spl, the de quasi standard mySQL was chosen.

Django offers a powerful template system, that allows to render the data in any possible form.
Usually it's used to render html pages, but this setup uses it to return JSON data obejcts to the client app.
The template system is used, to render the result views, that function on their own and only represent generated data.

To simulate the models, the server needs to connect to the simulation software and fire it up.
This is done using a task distribution system (Celery), that gets introduced in \secref{worker}.







\subsubsection{The Design}








